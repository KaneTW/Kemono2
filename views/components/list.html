{% if results|length == 0 %}
  <div class="no-posts">
    <h1 class="subtitle">Nobody here but us chickens!</h1>
  </div>
{% else %}
  <div class="opts">
    <select id="posts_layout" name="posts_layout">
      <option value="card" {{ 'selected' if request.cookies.get('layout') == 'card' }}>Cards</option>
      <option value="grid" {{ 'selected' if request.cookies.get('layout') == 'grid' }}>Grid</option>
    </select>
  </div>
  <div class="paginator" id="paginator-top">
    {% include 'components/paginator.html' %}
    <form
      action="{{ request.path }}"
      method="GET"
      enctype="application/x-www-form-urlencoded"
    >
      <input
        type="text"
        name="q"
        id="q"
        autocomplete="off"
        value="{{ request.args.get('q') if request.args.get('q') }}"
        placeholder="search for posts..."
      >
      <input type="submit" style="display: none;">
    </form>
  </div>
  {% if request.cookies.get('layout') == 'card' or not request.cookies.get('layout') %}
    <div class="content" id="content">
      <div class="pure-g">
        {% for post in results %}
          {% if not session.get('blocked') or post.service ~ ':' ~ post.user not in session.get('blocked') %}
            {% set flagged = result_flagged[loop.index0] %}
            {% set previews = result_previews[loop.index0] %}
            {% set attachments = result_attachments[loop.index0] %}
            {% set after_kitsune = result_after_kitsune[loop.index0] %}
            {% with post=post %}
              {% include 'components/card.html' %}
            {% endwith %}
          {% endif %}
        {% endfor %}
      </div>
    </div>
  {% elif request.cookies.get('layout') == 'grid' %}
    <div class="content" id="content">
      <div class="content-grid">
        {% for post in results %}
          {% if not session.get('blocked') or post.service ~ ':' ~ post.user not in session.get('blocked') %}
            {% with post=post %}
              {% include 'components/preview.html' %}
            {% endwith %}
          {% endif %}
        {% endfor %}
      </div>
    </div>
  {% endif %}
  <div class="paginator" id="paginator-bottom">
    {% include 'components/paginator.html' %}
  </div>
  <script src="{{ url_for('static', filename='js/layout.js') }}"></script>
{% endif %}